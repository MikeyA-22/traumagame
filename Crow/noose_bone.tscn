[gd_scene load_steps=22 format=3 uid="uid://ca52yb5i5ot6e"]

[ext_resource type="Script" uid="uid://d0xlfghtlxf2a" path="res://Crow/character_body_3d.gd" id="1_5hwkx"]
[ext_resource type="Script" uid="uid://dauw6ec6d3vuv" path="res://Crow/noose_bone.gd" id="1_ba1t2"]
[ext_resource type="Script" uid="uid://loiqn8geymex" path="res://Crow/crow_state_machine.gd" id="3_uddmk"]
[ext_resource type="Script" uid="uid://03dk5u32q6u6" path="res://Crow/hover.gd" id="4_byl21"]
[ext_resource type="Script" uid="uid://dsjrb13ig4gak" path="res://Crow/canstun.gd" id="5_de1t2"]
[ext_resource type="Script" uid="uid://dx6ocglsn3v3n" path="res://Crow/stun.gd" id="6_de1t2"]

[sub_resource type="SphereShape3D" id="SphereShape3D_tx5ut"]
radius = 0.05

[sub_resource type="CylinderShape3D" id="CylinderShape3D_78wmc"]
custom_solver_bias = 0.009
height = 0.05
radius = 0.009

[sub_resource type="CylinderMesh" id="CylinderMesh_q4017"]
top_radius = 0.009
bottom_radius = 0.009
height = 0.05

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_5uwn6"]
albedo_color = Color(1, 0, 0, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_tx5ut"]
albedo_color = Color(0, 0.533333, 1, 1)

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_5hwkx"]
albedo_color = Color(1, 0, 0, 1)

[sub_resource type="SphereShape3D" id="SphereShape3D_5hwkx"]
radius = 0.0350477

[sub_resource type="StandardMaterial3D" id="StandardMaterial3D_wtc8g"]
albedo_color = Color(0, 0, 0, 1)
metallic = 1.0
metallic_specular = 0.0

[sub_resource type="CylinderShape3D" id="CylinderShape3D_de1t2"]
height = 2.49316
radius = 0.689941

[sub_resource type="Animation" id="Animation_ba1t2"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("effect_area/effectcollision:disabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("effect_area/effectcollision:scale:x")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}
tracks/2/type = "bezier"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("effect_area/effectcollision:scale:y")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}
tracks/3/type = "bezier"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("effect_area/effectcollision:scale:z")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}

[sub_resource type="Animation" id="Animation_byl21"]
resource_name = "stun"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("effect_area/effectcollision:disabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0.9),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("effect_area/effectcollision:scale:x")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}
tracks/2/type = "bezier"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("effect_area/effectcollision:scale:y")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}
tracks/3/type = "bezier"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("effect_area/effectcollision:scale:z")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}

[sub_resource type="Animation" id="Animation_uddmk"]
resource_name = "idle"
loop_mode = 1
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("effect_area/effectcollision:disabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [false]
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("effect_area/effectcollision:scale:x")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}
tracks/2/type = "bezier"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("effect_area/effectcollision:scale:y")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}
tracks/3/type = "bezier"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("effect_area/effectcollision:scale:z")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"handle_modes": PackedInt32Array(0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0)
}

[sub_resource type="Animation" id="Animation_de1t2"]
resource_name = "stun"
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("effect_area/effectcollision:disabled")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 1,
"values": [true]
}
tracks/1/type = "bezier"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("effect_area/effectcollision:scale:x")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"handle_modes": PackedInt32Array(0, 0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0, 0.01, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0, 1)
}
tracks/2/type = "bezier"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath("effect_area/effectcollision:scale:y")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"handle_modes": PackedInt32Array(0, 0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0, 0.01, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0, 1)
}
tracks/3/type = "bezier"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("effect_area/effectcollision:scale:z")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"handle_modes": PackedInt32Array(0, 0),
"points": PackedFloat32Array(1, -0.25, 0, 0.25, 0, 0.01, -0.25, 0, 0.25, 0),
"times": PackedFloat32Array(0, 1)
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_byl21"]
_data = {
&"RESET": SubResource("Animation_ba1t2"),
&"canstun": SubResource("Animation_byl21"),
&"idle": SubResource("Animation_uddmk"),
&"stun": SubResource("Animation_de1t2")
}

[sub_resource type="CylinderShape3D" id="CylinderShape3D_ba1t2"]
height = 1.53857
radius = 2.0

[node name="NooseBone" type="Node3D"]
script = ExtResource("1_ba1t2")

[node name="StaticBody3D" type="StaticBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 0.771103, 0.636711, 0, -0.636711, 0.771103, 0, 0, 0)
collision_layer = 8
collision_mask = 8

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D"]
shape = SubResource("SphereShape3D_tx5ut")

[node name="NooseBone" type="RigidBody3D" parent="StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, -0.771102, 0.636711, 0, -0.636711, -0.771102, 0, -0.0543603, -0.0448861)
collision_layer = 8
collision_mask = 8

[node name="PinJoint3D" type="PinJoint3D" parent="StaticBody3D/NooseBone"]
transform = Transform3D(1, 0, 0, 0, -1, -8.74228e-08, 0, 8.74228e-08, -1, 0, -0.0284133, -3.00725e-09)
node_a = NodePath("../..")
node_b = NodePath("..")
params/bias = 0.4

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D/NooseBone"]
shape = SubResource("CylinderShape3D_78wmc")

[node name="CSGMesh3D" type="CSGMesh3D" parent="StaticBody3D/NooseBone"]
mesh = SubResource("CylinderMesh_q4017")
material = SubResource("StandardMaterial3D_5uwn6")

[node name="NooseBone2" type="RigidBody3D" parent="StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, -0.771102, 0.636711, 0, -0.636711, -0.771102, 0, -0.101087, -0.0834687)
collision_layer = 8
collision_mask = 8

[node name="PinJoint3D" type="PinJoint3D" parent="StaticBody3D/NooseBone2"]
transform = Transform3D(1, 0, 0, 0, -1, -8.74228e-08, 0, 8.74228e-08, -1, 0, -0.0295858, 6.18558e-09)
node_a = NodePath("../../NooseBone")
node_b = NodePath("..")
params/bias = 0.4

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D/NooseBone2"]
shape = SubResource("CylinderShape3D_78wmc")

[node name="CSGMesh3D" type="CSGMesh3D" parent="StaticBody3D/NooseBone2"]
mesh = SubResource("CylinderMesh_q4017")
material = SubResource("StandardMaterial3D_tx5ut")

[node name="NooseBone3" type="RigidBody3D" parent="StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, -0.771102, 0.636711, 0, -0.636711, -0.771102, 0, -0.150631, -0.124378)
collision_layer = 8
collision_mask = 8

[node name="PinJoint3D" type="PinJoint3D" parent="StaticBody3D/NooseBone3"]
transform = Transform3D(1, 0, 0, 0, -1, -8.74229e-08, 0, 8.74229e-08, -1, 0, -0.0259228, 3.70432e-09)
node_a = NodePath("../../NooseBone2")
node_b = NodePath("..")
params/bias = 0.4

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D/NooseBone3"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0121593, -7.24754e-09)
shape = SubResource("CylinderShape3D_78wmc")

[node name="CSGMesh3D" type="CSGMesh3D" parent="StaticBody3D/NooseBone3"]
mesh = SubResource("CylinderMesh_q4017")
material = SubResource("StandardMaterial3D_5hwkx")

[node name="NooseBone4" type="RigidBody3D" parent="StaticBody3D"]
transform = Transform3D(1, 0, 0, 0, -0.771102, 0.636711, 0, -0.636711, -0.771102, 0, -0.201993, -0.166788)
collision_layer = 8
collision_mask = 8

[node name="PinJoint3D" type="PinJoint3D" parent="StaticBody3D/NooseBone4"]
transform = Transform3D(1, 0, 0, 0, -1, -8.74228e-08, 0, 8.74228e-08, -1, 0, -0.033771, 8.97444e-09)
node_a = NodePath("../../NooseBone3")
node_b = NodePath("..")
params/bias = 0.4

[node name="CollisionShape3D" type="CollisionShape3D" parent="StaticBody3D/NooseBone4"]
shape = SubResource("CylinderShape3D_78wmc")

[node name="CSGMesh3D" type="CSGMesh3D" parent="StaticBody3D/NooseBone4"]
mesh = SubResource("CylinderMesh_q4017")
material = SubResource("StandardMaterial3D_5hwkx")

[node name="Crow" type="CharacterBody3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.335322, 0)
collision_layer = 8
collision_mask = 8
motion_mode = 1
script = ExtResource("1_5hwkx")

[node name="CollisionShape3D" type="CollisionShape3D" parent="Crow"]
shape = SubResource("SphereShape3D_5hwkx")

[node name="CSGSphere3D" type="CSGSphere3D" parent="Crow"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0045082, 0)
radius = 0.035
material = SubResource("StandardMaterial3D_wtc8g")

[node name="PinJoint3D" type="PinJoint3D" parent="Crow"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0427195, 0)
node_a = NodePath("../../StaticBody3D/NooseBone4")
node_b = NodePath("..")
params/bias = 0.01

[node name="hitbox" type="Area3D" parent="Crow"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 1)
collision_layer = 32
collision_mask = 32

[node name="CollisionShape3D" type="CollisionShape3D" parent="Crow/hitbox"]
transform = Transform3D(1, 0, 0, 0, -4.37114e-08, -1, 0, 1, -4.37114e-08, 0, 0, 0.246582)
shape = SubResource("CylinderShape3D_de1t2")

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_byl21")
}

[node name="StateMachine" type="Node" parent="." node_paths=PackedStringArray("animation_player", "character")]
script = ExtResource("3_uddmk")
animation_player = NodePath("../AnimationPlayer")
character = NodePath("../Crow")

[node name="Idle" type="Node" parent="StateMachine"]
script = ExtResource("4_byl21")
speed = 1.5
y_pos = 1.0
z_min = 1.5
z_max = 3.0
state_name = "idle"
animation = "idle"

[node name="Canstun" type="Node" parent="StateMachine"]
script = ExtResource("5_de1t2")
state_name = "canstun"
animation = "canstun"
metadata/_custom_type_script = "uid://cg8hvaar0rx7c"

[node name="Stun" type="Node" parent="StateMachine"]
script = ExtResource("6_de1t2")
y_pos = -1.0
state_name = "stun"
animation = "stun"
metadata/_custom_type_script = "uid://cg8hvaar0rx7c"

[node name="effect_area" type="Area3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -1, 0)
collision_layer = 16
collision_mask = 16
monitorable = false

[node name="effectcollision" type="CollisionShape3D" parent="effect_area"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.230713, 0)
shape = SubResource("CylinderShape3D_ba1t2")

[node name="RayCast3D" type="RayCast3D" parent="."]
target_position = Vector3(0, 0, 1)
collision_mask = 48

[connection signal="body_entered" from="Crow/hitbox" to="StateMachine/Canstun" method="_on_hitbox_body_entered"]
[connection signal="body_entered" from="effect_area" to="StateMachine/Idle" method="_on_effect_area_body_entered"]
[connection signal="body_exited" from="effect_area" to="StateMachine/Canstun" method="_on_effect_area_body_exited"]
